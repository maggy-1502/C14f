<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Carta de San Valent√≠n</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{
    touch-action: manipulation;
    font-family:'Segoe UI',sans-serif;
    background:#ffc0cb;
    color:#fff;
    overflow:hidden;
    height:100vh;
    display:flex;
    justify-content:center;
    align-items:center;
     margin: 0;
    overflow: hidden;
    background: radial-gradient(circle at bottom, #0d1b2a, #000814 70%);
}

/* contenedor del cielo */
.cielo {
    position: fixed;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
    z-index: 0;
    overflow: hidden;
    pointer-events: none;
}

.estrella-fondo {
    position: absolute;
    color: white;
    pointer-events: none;
    animation: titilar 3s infinite alternate;
}

@keyframes titilar {
    from { opacity: 0.3; }
    to { opacity: 1; }
}
/* Pantallas */
.pantalla{
    position:relative;
    z-index: 5;
    width:100%;
    height:100%;
    display:flex;
    flex-direction:column;
    justify-content:center;
    align-items:center;
    transition:opacity 1s;
    pointer-events: auto;
}
.oculto{display:none;}
/* Bot√≥n */
button{
    position: relative;
    z-index: 9999;
    padding:10px 20px;
    font-size:1.2rem;
    background-color:#ff6b81;
    border:none;
    border-radius:10px;
    cursor:pointer;
    color:white;
    margin-top:20px;
    transition:transform 0.2s;
}
button:hover{transform:scale(1.1);}
/* Sobre 3D */
.sobre{
    width:260px;
    height:180px;
    background:#ff6b81;
    position:relative;
    border-radius:12px;
    display:flex;
    justify-content:center;
    align-items:center;
    transform-style:preserve-3d;
    transition:transform 1s, opacity 1s;
    cursor:pointer;
    pointer-events:none;
    opacity:0;
}
.sobre.visible{opacity:1; pointer-events:auto;}
.solapa{
    width:100%;
    height:100%;
    background:#e44;
    border-top-left-radius:10px;
    border-top-right-radius:10px;
}
.solapa-contenedor{
    position:absolute;
    top:0;
    left:0;
    width:100%;
    height:50%;
    transform-origin:top;
    transition:transform 1.2s ease;
    z-index:3;
}
/* ABIERTA */
.sobre.abierto .solapa-contenedor{
    transform:rotateX(-160deg);
}
/* CERRADA */
.sobre.cerrado .solapa-contenedor{
    transform:rotateX(0deg);
}
/* Carta */
.carta{
    width:300px;
    height:400px;
    background:white;
    color:black;
    font-style:italic;
    font-size:1.2rem;
    padding:20px;
    position:absolute;
    top:50%;
    left:50%;
    transform:translate(-50%, -50%) translateY(80px);
    opacity:0;
    border-radius:15px;
    box-shadow:0 0 15px rgba(0,0,0,0.3);
    transition:opacity 1.2s ease, transform 1.2s ease;
    pointer-events:none;
}
.carta.mostrada{opacity:1; transform:translate(-50%, -50%) translateY(-40px);}
.carta.guardada{opacity:0; transform:translate(-50%, -50%) translateY(80px);}
/* Coraz√≥n final */
#corazon-final{
    position:fixed;
    top:50%;
    left:50%;
    font-size:8rem;
    transform:translate(-50%, -50%);
    transform-origin:center center;
    animation:latido 1.5s infinite;
    animation-play-state: paused;
    display:none;
    z-index:20;
}

@keyframes latido{
    0%{ transform: translate(-50%, -50%) scale(1); }
    50%{ transform: translate(-50%, -50%) scale(1.15); }
    100%{ transform: translate(-50%, -50%) scale(1); }
}
/* Lluvia de corazones */
.corazon-flotante{
    position:fixed;
    top: -40px;
    font-size:18px;
    animation:caer linear forwards;
    pointer-events: none;
    user-select: none;
}
@keyframes caer{
    from {
        transform:translate(0, 0);
        opacity:1;
    }
    to {
        transform:translate(var(--viento),100vh);
        opacity:0;
    }
}
/* Modo noche */
body.noche{background:#2c003e;color:white;}
body.noche .sobre{background:#ff4b81;}
body.noche .solapa{background:#ff1f6e;}
/* Estrellas */

.estrella{
    position: absolute;
    color: white;
    pointer-events: none;
    animation: titilar 2.5s infinite alternate;
    text-shadow:
        0 0 4px white,
        0 0 8px rgba(255,255,255,0.6);
}
@keyframes titilar{
    0%{
        opacity:0.3;
        transform:scale(0.7);
    }
    100%{
        opacity:1;
        transform:scale(1);
    }
}
.sello{
    position:absolute;
    top:85px;
    left:50%;
    transform:translateX(-50%) rotate(0deg);
    width:46px;
    height:46px;
    background:white;
    border-radius:50%;
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:20px;
    box-shadow:0 5px 10px rgba(0,0,0,0.25);
    z-index:5;
}
    .corazon-touch {
    position: fixed;
    pointer-events: none;
    font-size: 18px;
    z-index: 9999;
    animation: explosion 0.8s ease-out forwards;
}

@keyframes explosion {
    from {
        transform: translate(0,0) scale(1);
        opacity: 1;
    }
    to {
        transform: translate(var(--dx), var(--dy)) scale(0.4);
        opacity: 0;
    }
}
</style>
</head>
<body>

<!-- Pantalla inicial -->
<div id="pantalla-inicial" class="pantalla">
    <h1>Feliz San Valent√≠n</h1>
    <button id="btn-siguiente">Siguiente</button>
</div>

<!-- Pantalla de la carta -->
<div id="pantalla-carta" class="pantalla oculto">
    <div id="sobre" class="sobre">
        <div class="solapa-contenedor">
            <div class="solapa"></div>
        </div>
        <div class="sello">ü©∑</div>
    </div>
    <div id="carta" class="carta"></div>
</div>

<!-- Coraz√≥n final -->
<div id="corazon-final">‚ù§Ô∏è</div>

<!-- M√∫sica -->
<audio id="musica" src="es-verdad-video-oficial.mp3"></audio>

<script>
window.onload = () => {
    const pantallaInicial = document.getElementById('pantalla-inicial');
    const pantallaCarta = document.getElementById('pantalla-carta');
    const btnSiguiente = document.getElementById('btn-siguiente');
    const sobre = document.getElementById('sobre');
    const carta = document.getElementById('carta');
    const musica = document.getElementById('musica');
    const corazonFinal = document.getElementById('corazon-final');
    const body = document.body;
    musica.volume = 0.6;

    const mensaje = `Feliz San Valent√≠n, muchas gracias por estar.
Es el primer San Valent√≠n que paso con alguien jaja, y la verdad me hace muy feliz que seas t√∫. 
No soy muy buena escribiendo ni expresando lo que siento, pero quer√≠a intentar decirte que me importas much√≠simo. 
Este es el primer regalo que te hago, de muchos que pienso hacerte, as√≠ que vete acostumbrando jaja.
Gracias por hacer mis d√≠as m√°s lindos y por estar conmigo.
Te quiero mucho.`;

    // Modo noche
    const hora = new Date().getHours();
    if (hora >= 18 || hora < 6) body.classList.add('noche');

    // Bot√≥n Siguiente
    window.addEventListener("DOMContentLoaded", () => {

    const boton = document.getElementById("btn-siguiente");

    boton.addEventListener("click", siguientePantalla);

});

    // Abrir sobre
    sobre.addEventListener('click', () => {
        sobre.classList.remove('cerrado');
        sobre.classList.add('abierto');
        musica.play();
        setTimeout(() => {
            carta.classList.add('mostrada');
            escribirCarta();
        }, 800);
    });

    function escribirCarta() {
        let i = 0;
        carta.innerHTML = '';
        const intervalo = setInterval(() => {
            carta.innerHTML += mensaje.charAt(i);
            i++;
            carta.scrollTop = carta.scrollHeight;
            if (i === mensaje.length) {
                clearInterval(intervalo);
                // Pausa antes de cerrar
                setTimeout(() => {
                    carta.classList.remove('mostrada');
                    carta.classList.add('guardada');
                    setTimeout(() => {
                        sobre.classList.remove('abierto');
                        sobre.classList.add('cerrado');
                        setTimeout(() => {
                            pantallaCarta.classList.add('oculto');
                            pantallaCarta.style.pointerEvents = 'none';
                            corazonFinal.style.display = 'block';
                            corazonFinal.style.animationPlayState = 'running';
                            // Lluvia de corazones
                            crearLluviaCorazones();
                            if(body.classList.contains('noche')) crearCorazonEstrellas();
                        }, 1200);
                    }, 1200);
                }, 2000);
            }
        }, 50);
    }

    function crearLluviaCorazones(){
        setInterval(()=>{
            const heart = document.createElement('div');
            heart.classList.add('corazon-flotante');
            heart.style.left = Math.random() * window.innerWidth + 'px';
            heart.style.top = '-50px';
            const size = Math.random() * 1.5 + 0.8;
            heart.style.fontSize = size + "px";
            heart.style.color = '#ff4b81';
            heart.innerText = '‚ù§Ô∏è';
            const duration = Math.random() * 3 + 4;
            heart.style.animationDuration = duration + "s";
            document.body.appendChild(heart);
            const viento = Math.random() > 0.5 ? "30px" : "-30px";
            heart.style.setProperty("--viento",viento);
            setTimeout(() => heart.remove(), 6000);
        }, 300);
        if (document.querySelectorAll('.corazon').length > 40) return;
    }

    function crearCorazonEstrellas() {
    const centerX = window.innerWidth / 2;
    const centerY = window.innerHeight / 2;
    const scale = 12;
    const total = 160;

    for (let i = 0; i < total; i++) {
        const t = i / total * Math.PI * 2;

        const x = scale * 16 * Math.pow(Math.sin(t), 3);
        const y = -scale * (
            13 * Math.cos(t)
            - 5 * Math.cos(2 * t)
            - 2 * Math.cos(3 * t)
            - Math.cos(4 * t)
        );

        const star = document.createElement('div');
        star.className = 'estrella';

        // micro variaci√≥n para evitar amontonamientos
        const jitter = 0.8;
        star.style.left = (centerX + x + (Math.random() - 0.5) * jitter) + 'px';
        star.style.top  = (centerY + y + (Math.random() - 0.5) * jitter) + 'px';

        const size = Math.random() * 1.5 + 3;
        star.textContent = '‚òÖ';
star.style.fontSize = (Math.random() * 4 + 8) + 'px';

        document.body.appendChild(star);
    }
    function crearCielo() {
    const cielo = document.createElement('div');
    cielo.className = 'cielo';
    document.body.appendChild(cielo);

    const totalEstrellas = 150;

    for (let i = 0; i < totalEstrellas; i++) {
        const estrella = document.createElement('div');
        estrella.className = 'estrella-fondo';
        estrella.textContent = '‚òÖ';

        const sizeRandom = Math.random();

        // 3 capas de profundidad
        if (sizeRandom < 0.6) {
            estrella.style.fontSize = '6px';   // lejanas
            estrella.style.opacity = 0.4;
        } else if (sizeRandom < 0.9) {
            estrella.style.fontSize = '9px';   // medias
            estrella.style.opacity = 0.7;
        } else {
            estrella.style.fontSize = '12px';  // cercanas
            estrella.style.opacity = 1;
        }

        estrella.style.left = Math.random() * window.innerWidth + 'px';
        estrella.style.top = Math.random() * window.innerHeight + 'px';

        cielo.appendChild(estrella);
    }
}
crearCielo();
}
   document.body.addEventListener("pointerdown",crearExplosion);
function crearExplosion(e) {

    let x, y;

    if (e.touches && e.touches.length > 0) {
        x = e.touches[0].clientX;
        y = e.touches[0].clientY;
    } else {
        x = e.clientX;
        y = e.clientY;
    }

    for (let i = 0; i < 6; i++) {

        const corazon = document.createElement("div");
        corazon.className = "corazon-touch";
        corazon.textContent = "üíñ";

        corazon.style.left = x + "px";
        corazon.style.top = y + "px";

        const angulo = Math.random() * Math.PI * 2;
        const distancia = Math.random() * 60 + 30;

        corazon.style.setProperty("--dx", Math.cos(angulo) * distancia + "px");
        corazon.style.setProperty("--dy", Math.sin(angulo) * distancia + "px");

        document.body.appendChild(corazon);

        setTimeout(() => corazon.remove(), 800);
    }
}
}
    }
</script>
</body>
</html>

