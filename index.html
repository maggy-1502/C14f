<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Carta de San Valent√≠n</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{
    font-family:'Segoe UI',sans-serif;
    overflow:hidden;
    height:100vh;
    display:flex;
    justify-content:center;
    align-items:center;
    background: radial-gradient(circle at bottom, #0d1b2a, #000814 70%);
    color:white;
    touch-action: manipulation;
}

/* CIELO DE FONDO */
.cielo{
    position: fixed;
    width: 100%;
    height: 100%;
    top:0;
    left:0;
    z-index:0;
    pointer-events:none;
    overflow:hidden;
}
.estrella-fondo{
    position: absolute;
    color: white;
    pointer-events: none;
    animation: titilar 3s infinite alternate;
}
@keyframes titilar{
    from {opacity:0.3;}
    to {opacity:1;}
}

/* PANTALLAS */
.pantalla{
    position:relative;
    z-index:5;
    width:100%;
    height:100%;
    display:flex;
    flex-direction:column;
    justify-content:center;
    align-items:center;
    transition:opacity 1s;
}
.oculto{display:none;}

/* BOT√ìN */
button{
    position: relative;
    z-index:9999;
    padding:10px 20px;
    font-size:1.2rem;
    background-color:#ff6b81;
    border:none;
    border-radius:10px;
    cursor:pointer;
    color:white;
    margin-top:20px;
    transition:transform 0.2s;
}
button:hover{transform:scale(1.1);}

/* SOBRE 3D */
.sobre{
    width:260px;
    height:180px;
    background:#ff6b81;
    position:relative;
    border-radius:12px;
    display:flex;
    justify-content:center;
    align-items:center;
    transform-style:preserve-3d;
    transition:transform 1s, opacity 1s;
    cursor:pointer;
    pointer-events:none;
    opacity:0;
}
.sobre.visible{opacity:1; pointer-events:auto;}
.solapa{
    width:100%;
    height:100%;
    background:#e44;
    border-top-left-radius:10px;
    border-top-right-radius:10px;
}
.solapa-contenedor{
    position:absolute;
    top:0;
    left:0;
    width:100%;
    height:50%;
    transform-origin:top;
    transition:transform 1.2s ease;
    z-index:3;
}
.sobre.abierto .solapa-contenedor{transform:rotateX(-160deg);}
.sobre.cerrado .solapa-contenedor{transform:rotateX(0deg);}

/* CARTA */
.carta{
    width:300px;
    height:400px;
    background:white;
    color:black;
    font-style:italic;
    font-size:1.2rem;
    padding:20px;
    position:absolute;
    top:50%;
    left:50%;
    transform:translate(-50%, -50%) translateY(80px);
    opacity:0;
    border-radius:15px;
    box-shadow:0 0 15px rgba(0,0,0,0.3);
    transition:opacity 1.2s ease, transform 1.2s ease;
    pointer-events:none;
}
.carta.mostrada{opacity:1; transform:translate(-50%, -50%) translateY(-40px);}
.carta.guardada{opacity:0; transform:translate(-50%, -50%) translateY(80px);}

/* CORAZ√ìN FINAL */
#contenedor-corazon-final{
    position: fixed;
    inset:0;
    display:flex;
    justify-content:center;
    align-items:center;
    z-index:20;
    pointer-events:none;
    display:none;
}
#corazon-final span{
    font-size:8rem;
    line-height:1;
    display:block;
    animation:latido 1.5s infinite;
    animation-play-state: paused;
}
@keyframes latido{
    0%{transform: scale(1);}
    50%{transform: scale(1.15);}
    100%{transform: scale(1);}
}

/* LLUVIA DE CORAZONES */
.corazon-flotante{
    position:fixed;
    top:-40px;
    font-size:18px;
    animation:caer linear forwards;
    pointer-events:none;
    user-select:none;
    z-index:15;
}
@keyframes caer{
    from {transform:translate(0,0); opacity:1;}
    to {transform:translate(var(--viento),100vh); opacity:0;}
}

/* CORAZONES TOUCH */
.corazon-touch{
    position: fixed;
    pointer-events:none;
    font-size:18px;
    z-index:9999;
    animation:explosion 0.8s ease-out forwards;
}
@keyframes explosion{
    from {transform:translate(0,0) scale(1); opacity:1;}
    to {transform:translate(var(--dx),var(--dy)) scale(0.4); opacity:0;}
}

/* CORAZ√ìN DE ESTRELLAS CENTRAL */
.estrella{
    position:fixed;
    color:white;
    pointer-events:none;
    animation: titilar 2.5s infinite alternate;
    text-shadow: 0 0 4px white, 0 0 8px rgba(255,255,255,0.6);
    z-index:10;
}

/* MODO NOCHE */
body.noche{background:#2c003e;color:white;}
body.noche .sobre{background:#ff4b81;}
body.noche .solapa{background:#ff1f6e;}
</style>
</head>
<body>

<!-- CIELO -->
<div class="cielo" id="cielo"></div>

<!-- PANTALLA INICIAL -->
<div id="pantalla-inicial" class="pantalla">
    <h1>Feliz San Valent√≠n</h1>
    <button id="btn-siguiente">Siguiente</button>
</div>

<!-- PANTALLA CARTA -->
<div id="pantalla-carta" class="pantalla oculto">
    <div id="sobre" class="sobre">
        <div class="solapa-contenedor">
            <div class="solapa"></div>
        </div>
        <div class="sello">ü©∑</div>
    </div>
    <div id="carta" class="carta"></div>
</div>

<!-- CORAZ√ìN FINAL -->
<div id="contenedor-corazon-final">
    <div id="corazon-final">
        <span>‚ù§Ô∏è</span>
    </div>
</div>

<!-- M√öSICA -->
<audio id="musica" src="es-verdad-video-oficial.mp3"></audio>

<script>
window.onload = () => {
    const pantallaInicial = document.getElementById('pantalla-inicial');
    const pantallaCarta = document.getElementById('pantalla-carta');
    const btnSiguiente = document.getElementById('btn-siguiente');
    const sobre = document.getElementById('sobre');
    const carta = document.getElementById('carta');
    const musica = document.getElementById('musica');
    const corazonFinal = document.getElementById('corazon-final');
    const contenedorCorazon = document.getElementById('contenedor-corazon-final');
    const cielo = document.getElementById('cielo');
    const body = document.body;

    musica.volume = 0.6;

    const mensaje = `Feliz San Valent√≠n, muchas gracias por estar.
Es el primer San Valent√≠n que paso con alguien jaja, y la verdad me hace muy feliz que seas t√∫.
No soy muy buena escribiendo ni expresando lo que siento, pero quer√≠a intentar decirte que me importas much√≠simo.
Este es el primer regalo que te hago, de muchos que pienso hacerte, as√≠ que vete acostumbrando jaja.
Gracias por hacer mis d√≠as m√°s lindos y por estar conmigo.
Te quiero mucho.`;

    // MODO NOCHE
    const hora = new Date().getHours();
    if(hora>=18||hora<6) body.classList.add('noche');

    // CREAR CIELO
    function crearCielo(){
        const total = 150;
        for(let i=0;i<total;i++){
            const estrella = document.createElement('div');
            estrella.className='estrella-fondo';
            estrella.textContent='‚òÖ';
            const r = Math.random();
            if(r<0.6){ estrella.style.fontSize='6px'; estrella.style.opacity=0.4; }
            else if(r<0.9){ estrella.style.fontSize='9px'; estrella.style.opacity=0.7; }
            else { estrella.style.fontSize='12px'; estrella.style.opacity=1; }
            estrella.style.left = Math.random()*window.innerWidth+'px';
            estrella.style.top = Math.random()*window.innerHeight+'px';
            cielo.appendChild(estrella);
        }
    }
    crearCielo();

    // BOT√ìN SIGUIENTE
    btnSiguiente.addEventListener("click",()=>{
        pantallaInicial.classList.add("oculto");
        pantallaCarta.classList.remove("oculto");
        sobre.classList.add("visible");
    });

    // ABRIR SOBRE
    sobre.addEventListener("click",()=>{
        sobre.classList.add("abierto");
        musica.play();
        setTimeout(()=>{
            carta.classList.add("mostrada");
            escribirCarta();
        },800);
    });

    // ESCRIBIR CARTA
    function escribirCarta(){
        let i=0;
        carta.innerHTML='';
        const intervalo=setInterval(()=>{
            carta.innerHTML+=mensaje.charAt(i);
            i++;
            if(i>=mensaje.length){
                clearInterval(intervalo);
                setTimeout(()=>{
                    carta.classList.remove("mostrada");
                    setTimeout(()=>{
                        sobre.classList.remove("abierto");
                        setTimeout(()=>{
                            pantallaCarta.classList.add("oculto");
                            contenedorCorazon.style.display='flex';
                            corazonFinal.querySelector('span').style.animationPlayState='running';
                            crearCorazonEstrellas();
                            setTimeout(crearLluviaCorazones,400);
                        },1200);
                    },1200);
                },2000);
            }
        },45);
    }

    // CORAZ√ìN DE ESTRELLAS CENTRAL
    function crearCorazonEstrellas(){
        const centerX = window.innerWidth/2;
        const centerY = window.innerHeight/2;
        const scale = 12;
        const total = 140;
        for(let i=0;i<total;i++){
            const t = i/total*Math.PI*2;
            const x = scale*16*Math.pow(Math.sin(t),3);
            const y = -scale*(13*Math.cos(t)-5*Math.cos(2*t)-2*Math.cos(3*t)-Math.cos(4*t));
            const star = document.createElement('div');
            star.className='estrella';
            star.textContent='‚òÖ';
            star.style.left=(centerX+x)+'px';
            star.style.top=(centerY+y+10)+'px';
            star.style.fontSize='10px';
            document.body.appendChild(star);
        }
    }

    // LLUVIA DE CORAZONES
    function crearLluviaCorazones(){
        setInterval(()=>{
            const heart=document.createElement('div');
            heart.className='corazon-flotante';
            heart.textContent='‚ù§Ô∏è';
            heart.style.left=Math.random()*window.innerWidth+'px';
            heart.style.fontSize=(Math.random()*10+12)+'px';
            heart.style.setProperty('--viento',(Math.random()*60-30)+'px');
            document.body.appendChild(heart);
            setTimeout(()=>heart.remove(),6000);
        },600);
    }

    // CORAZONES TOUCH
    body.addEventListener("pointerdown",(e)=>{
        const x=e.clientX;
        const y=e.clientY;
        for(let i=0;i<6;i++){
            const c=document.createElement("div");
            c.className='corazon-touch';
            c.textContent='üíñ';
            c.style.left=x+'px';
            c.style.top=y+'px';
            const ang=Math.random()*Math.PI*2;
            const dist=Math.random()*60+20;
            c.style.setProperty('--dx',Math.cos(ang)*dist+'px');
            c.style.setProperty('--dy',Math.sin(ang)*dist+'px');
            document.body.appendChild(c);
            setTimeout(()=>c.remove(),800);
        }
    });
};
</script>
</body>
</html>
